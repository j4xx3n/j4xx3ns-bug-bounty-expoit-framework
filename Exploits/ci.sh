#!/bin/bash

list=""
output=""
unix=false
windows=flase

while getopts "l:o:uw" opt; do
  case $opt in
    l)
      list=$OPTARG
     ;;
    o)
      output=$OPTARG
      ;;
    *)
      echo "Usage"
      echo "====="
      echo "List: $0 -l <list> -o <output>"
      exit 1
      ;;
  esac
done

# Make a directory for command injection results
mkdir $output/CI


# Scan list with commix
cat $list | urldedupe | grep -E "\.php|\.asp|\.aspx|\.jsp" | grep "=" | commix -u "$url" --level=5 --risk=3 --batch --output=$output/CI/commixScan.txt


# Fuzz list with ffuf
#cat $list | urldedupe | grep -E "\.php|\.asp|\.aspx|\.jsp" | grep "=" | qsreplace FUZZ | 


