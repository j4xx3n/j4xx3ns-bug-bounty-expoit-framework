#!/bin/bash

list=""
output=""

while getopts "l:o:" opt; do
  case $opt in
    l)
      list=$OPTARG
      ;;
    o)
      output=$OPTARG
      ;;
    *)
      echo "Usage"
      echo "====="
      echo "List: $0 -l <list> -o <output>"
      exit 1
      ;;
  esac
done


# Clean list with urldedupe
cat $list | urldedupe | grep '=' >> $output/lfiCleanList.txt


# Scan list with nuclei using lfi tags
nuclei -l $output/lfiCleanList.txt -tags lfi | tee -a $output/lfiResults.txt


# Fuzz list with ffuf
cat $output/lfiCleanList.txt | qsreplace 'FUZZ' | while read i; do ffuf -u $i -w ../Payloads/lfi.txt -c -mr 'root:' | tee -a $output/lfiResults.txt; done
